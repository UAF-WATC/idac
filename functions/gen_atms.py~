####################################
## ---- Generate Atmospheres ---- ##
####################################

import os
import subprocess
import numpy as np

project_dir = '/home/alex/projects/infid/sandbox/hrr_eg1/'


## where to save the atmospheres
atm_save_dir = project_dir + 'modeled_data/atmospheres/'

## where to build the atmospheres
atm_build_dir = atm_save_dir + 'building_room'

## change to the directory where you want to build the atmosheres
os.chdir(atm_build_dir)

##############
### INPUTS ###
##############

## define the inputs
year = '2012'
month = '8'
day = '31'
hour = '17'
##lon = '-107.785103'
##lat = '32.532398'
ap = '10.'
f107 = '77'
zmax = '200'
dz = '0.1'

## create a list of lat and longs.
lats = np.linspace(30, 50, 4)
longs = np.linspace(70, 120, 4)

## create a grid of atmospheres
lat_longs = np.zeros((len(lats)*len(longs),2))
lat_longs[:] = np.nan

i=0
k=0
while i < len(lats):
    j=0
    while j < len(longs):
        lat_longs[k,:] = [lats[i], longs[j]]
        k=k+1
        j=j+1
    #
    i=i+1
#


## looop over the lat and longs
i=0
while i < len(lat_longs):
    cur_lat = str(lat_longs[i,0])
    cur_lon = str(lat_longs[i,1])

    ## build the command
    build_atm_cmd=['probe_HWT14', year, month, day, hour, cur_lon, cur_lat, ap, f107, zmax, dz]

    ## run the command to build the atmospheres
    subprocess.run(build_atm_cmd)

    ##################################################
    ## COPY THE ATMOSPHERE OUT OF THE BUILDING ROOM ##
    ##################################################

    ## prepare to save the atmosphere
    save_month = month
    save_day = day

    ## check if the month or day needs a 0 in front
    if int(day) < 10:
        save_day = '0' + day
    #
    if int(month) < 10:
        save_month = '0' + month
    #

    ## define what the atmospheric file name will be
    atm_file=year + save_month + save_day + '_' + cur_lat + '_' + cur_lon + '.dat'

    ## copy the data from the building room up a directory
    copy_atm_cmd = ['cp', 'sonde_ztuvrp.dat', atm_save_dir + atm_file]

    ## run the copy command
    subprocess.run(copy_atm_cmd)


    i=i+1
#

    






